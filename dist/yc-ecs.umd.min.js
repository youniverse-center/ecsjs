!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).YcsEcs={})}(this,(function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function o(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r=function(){function t(n,o){e(this,t),i(this,"entityId",void 0),i(this,"registry",void 0),this.entityId=n,this.registry=o}return o(t,[{key:"id",get:function(){return this.entityId}},{key:"hasComponent",value:function(t){return this.registry.hasComponent(this.entityId,t)}},{key:"addComponent",value:function(t,e){return this.registry.assignComponent(this.entityId,t,e)}},{key:"removeComponent",value:function(t){this.registry.removeComponent(this.entityId,t)}},{key:"getComponent",value:function(t){return this.registry.getComponent(this.entityId,t)}}]),t}(),s=function(){function t(n,o){e(this,t),i(this,"groupAll",void 0),i(this,"groupAny",void 0),i(this,"resultMap",new Map),this.groupAll=n,this.groupAny=o}return o(t,[{key:"addComponent",value:function(t,e,n){var o=this.resultMap.get(t);o||(o=new Map,this.resultMap.set(t,o)),o.set(e,n)}},{key:"result",get:function(){var t=[];return this.resultMap.forEach((function(e,n){t.push({entity:n,component:function(t){return e.get(t)},hasComponent:function(t){return e.has(t)}})})),t}}]),t}(),u=function(){function t(){e(this,t),i(this,"entityComponents",new Map),i(this,"components",new Map),i(this,"nextEntity",1),i(this,"listeners",{componentAdded:[],componentRemoved:[],entityCreated:[],entityRemoved:[]})}return o(t,[{key:"getComponentMap",value:function(t){return this.components.has(t)||this.components.set(t,new Map),this.components.get(t)}},{key:"createEntity",value:function(){var t=new r(this.nextEntity,this);return this.nextEntity+=1,this.entityComponents.set(t.id,new Set),this.listeners.entityCreated.forEach((function(e){e(t)})),t}},{key:"hasComponent",value:function(t,e){return this.getComponentMap(e).has(t)}},{key:"assignComponent",value:function(t,e,n){var o=this,i=this.entityComponents.get(t);return i&&(i.add(e),this.getComponentMap(e).set(t,n)),this.listeners.componentAdded.forEach((function(i){i(new r(t,o),e,n)})),n}},{key:"removeComponent",value:function(t,e){var n=this,o=this.entityComponents.get(t);if(o){var i=this.getComponent(t,e);this.listeners.componentRemoved.forEach((function(o){o(new r(t,n),e,i)})),o.delete(e)}this.getComponentMap(e).delete(t)}},{key:"getComponent",value:function(t,e){var n=this.getComponentMap(e).get(t);if(!n)throw new Error("Entity ".concat(t," does not have component ").concat(e));return n}},{key:"removeEntity",value:function(t){var e=this,n=this.entityComponents.get(t);n&&(this.listeners.entityRemoved.forEach((function(n){n(new r(t,e))})),n.forEach((function(n){e.removeComponent(t,n)})),this.entityComponents.delete(t))}},{key:"getView",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=new s(t,n);return this.entityComponents.forEach((function(i,s){var u=Array.from(i),a=t.filter((function(t){return u.includes(t)}));if(a.length===t.length){var c=new r(s,e);n.filter((function(t){return u.includes(t)})).concat(a).forEach((function(t){var n=e.getComponent(s,t);n&&o.addComponent(c,t,n)}))}})),o}},{key:"registerListener",value:function(t,e){this.listeners[t].push(e)}}]),t}(),a=function(){return new u};t.createRegistry=a,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=yc-ecs.umd.min.js.map
